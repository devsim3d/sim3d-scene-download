!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let r,c;function a(t,e){return r||(r=document.createElement("a")),r.href=e,t===r.href}function i(t){return null==t?"":t}function u(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function v(){return m(" ")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function y(t){c=t}function w(t){(function(){if(!c)throw new Error("Function called outside component initialization");return c})().$$.on_mount.push(t)}const _=[],E=[],C=[],k=[],A=Promise.resolve();let P=!1;function L(t){C.push(t)}const I=new Set;let S=0;function T(){const t=c;do{for(;S<_.length;){const t=_[S];S++,y(t),j(t.$$)}for(y(null),_.length=0,S=0;E.length;)E.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];I.has(e)||(I.add(e),e())}C.length=0}while(_.length);for(;k.length;)k.pop()();P=!1,I.clear(),y(t)}function j(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(L)}}const M=new Set;function N(t,e){-1===t.$$.dirty[0]&&(_.push(t),P||(P=!0,A.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function O(l,r,a,i,u,f,h,p=[-1]){const m=c;y(l);const v=l.$$={fragment:null,ctx:null,props:f,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(m?m.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:r.target||m.$$.root};h&&h(v.root);let g=!1;if(v.ctx=a?a(l,r.props||{},((t,e,...n)=>{const s=n.length?n[0]:e;return v.ctx&&u(v.ctx[t],v.ctx[t]=s)&&(!v.skip_bound&&v.bound[t]&&v.bound[t](s),g&&N(l,t)),e})):[],v.update(),g=!0,s(v.before_update),v.fragment=!!i&&i(v.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);v.fragment&&v.fragment.l(t),t.forEach(d)}else v.fragment&&v.fragment.c();r.intro&&((x=l.$$.fragment)&&x.i&&(M.delete(x),x.i(b))),function(t,n,l,r){const{fragment:c,on_mount:a,on_destroy:i,after_update:u}=t.$$;c&&c.m(n,l),r||L((()=>{const n=a.map(e).filter(o);i?i.push(...n):s(n),t.$$.on_mount=[]})),u.forEach(L)}(l,r.target,r.anchor,r.customElement),T()}var x,b;y(m)}function H(t,e,n){const s=t.slice();return s[27]=e[n],s}function D(t,e,n){const s=t.slice();return s[30]=e[n],s}function G(t,e,n){const s=t.slice();return s[33]=e[n],s}function U(t){let e,n,s,o,l,r,c,h,$,y,w,_,E=t[33].name+"";function C(){return t[17](t[33])}return{c(){e=p("tr"),n=p("th"),s=m(E),o=v(),l=p("th"),r=p("img"),$=v(),x(n,"class","svelte-1xo9i92"),a(r.src,c=t[33].thumb)||x(r,"src",c),x(r,"alt",h=t[33].thumb),x(r,"class","svelte-1xo9i92"),x(l,"class","svelte-1xo9i92"),x(e,"class",y=i(t[33].name===t[6]?"current":"")+" svelte-1xo9i92")},m(t,c){f(t,e,c),u(e,n),u(n,s),u(e,o),u(e,l),u(l,r),u(e,$),w||(_=g(e,"click",C),w=!0)},p(n,o){t=n,32&o[0]&&E!==(E=t[33].name+"")&&b(s,E),32&o[0]&&!a(r.src,c=t[33].thumb)&&x(r,"src",c),32&o[0]&&h!==(h=t[33].thumb)&&x(r,"alt",h),96&o[0]&&y!==(y=i(t[33].name===t[6]?"current":"")+" svelte-1xo9i92")&&x(e,"class",y)},d(t){t&&d(e),w=!1,_()}}}function q(t){let e,n,o,l,r,c,a,i,m,b,$,y,w=t[10],_=[];for(let e=0;e<w.length;e+=1)_[e]=B(D(t,w,e));let E=t[4],C=[];for(let e=0;e<E.length;e+=1)C[e]=F(H(t,E,e));return{c(){e=p("label"),e.textContent="Cliente:",n=v(),o=p("select");for(let t=0;t<_.length;t+=1)_[t].c();l=v(),r=p("button"),r.textContent="Cerrar Sesión",c=v(),a=p("div"),i=p("table"),m=p("tr"),m.innerHTML='<th class="svelte-1xo9i92"><h1 class="svelte-1xo9i92">Escena</h1></th> \n                <th class="svelte-1xo9i92"><h1 class="svelte-1xo9i92">Nombre</h1></th> \n                <th class="svelte-1xo9i92"><h1 class="svelte-1xo9i92">Vista Previa</h1></th>',b=v();for(let t=0;t<C.length;t+=1)C[t].c();x(e,"for","currentClient"),x(e,"class","svelte-1xo9i92"),x(o,"id","currentClient"),x(o,"class","svelte-1xo9i92"),x(r,"class","svelte-1xo9i92"),x(m,"class","table-header svelte-1xo9i92"),x(i,"class","svelte-1xo9i92"),x(a,"class","scene-list svelte-1xo9i92")},m(s,d){f(s,e,d),f(s,n,d),f(s,o,d);for(let t=0;t<_.length;t+=1)_[t].m(o,null);f(s,l,d),f(s,r,d),f(s,c,d),f(s,a,d),u(a,i),u(i,m),u(i,b);for(let t=0;t<C.length;t+=1)C[t].m(i,null);$||(y=[g(o,"change",t[13]),g(r,"click",t[12])],$=!0)},p(t,e){if(1024&e[0]){let n;for(w=t[10],n=0;n<w.length;n+=1){const s=D(t,w,n);_[n]?_[n].p(s,e):(_[n]=B(s),_[n].c(),_[n].m(o,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=w.length}if(16400&e[0]){let n;for(E=t[4],n=0;n<E.length;n+=1){const s=H(t,E,n);C[n]?C[n].p(s,e):(C[n]=F(s),C[n].c(),C[n].m(i,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=E.length}},d(t){t&&d(e),t&&d(n),t&&d(o),h(_,t),t&&d(l),t&&d(r),t&&d(c),t&&d(a),h(C,t),$=!1,s(y)}}}function z(t){let e,n,o,l,r,c,a,i,h,m,b,y,w,_,E,C,k,A,P;return{c(){e=p("div"),n=p("h1"),n.textContent="Login",o=v(),l=p("input"),r=v(),c=p("form"),a=p("div"),i=p("label"),i.textContent="User",h=v(),m=p("input"),b=v(),y=p("div"),w=p("label"),w.textContent="Password",_=v(),E=p("input"),C=v(),k=p("div"),k.innerHTML='<button type="submit" class="svelte-1xo9i92">Login</button>',x(n,"class","svelte-1xo9i92"),x(l,"type","text"),x(l,"class","svelte-1xo9i92"),x(i,"for","user"),x(i,"class","svelte-1xo9i92"),x(m,"type","text"),x(m,"id","user"),x(m,"class","svelte-1xo9i92"),x(a,"class","svelte-1xo9i92"),x(w,"for","pass"),x(w,"class","svelte-1xo9i92"),x(E,"type","password"),x(E,"id","pass"),x(E,"class","svelte-1xo9i92"),x(y,"class","svelte-1xo9i92"),x(k,"class","svelte-1xo9i92"),x(c,"class","svelte-1xo9i92"),x(e,"class","svelte-1xo9i92")},m(s,d){f(s,e,d),u(e,n),u(e,o),u(e,l),$(l,t[3]),u(e,r),u(e,c),u(c,a),u(a,i),u(a,h),u(a,m),$(m,t[7]),u(c,b),u(c,y),u(y,w),u(y,_),u(y,E),$(E,t[8]),u(c,C),u(c,k),A||(P=[g(l,"input",t[18]),g(m,"input",t[19]),g(E,"input",t[20]),g(c,"submit",t[11])],A=!0)},p(t,e){8&e[0]&&l.value!==t[3]&&$(l,t[3]),128&e[0]&&m.value!==t[7]&&$(m,t[7]),256&e[0]&&E.value!==t[8]&&$(E,t[8])},d(t){t&&d(e),A=!1,s(P)}}}function B(t){let e,n,s,o=t[30].name+"";return{c(){e=p("option"),n=m(o),e.__value=s=t[30].id,e.value=e.__value,x(e,"class","svelte-1xo9i92")},m(t,s){f(t,e,s),u(e,n)},p(t,l){1024&l[0]&&o!==(o=t[30].name+"")&&b(n,o),1024&l[0]&&s!==(s=t[30].id)&&(e.__value=s,e.value=e.__value)},d(t){t&&d(e)}}}function F(t){let e,n,s,o,l,r,c,i,h,$,y,w,_,E,C,k,A=t[27].id+"",P=t[27].name+"";function L(){return t[21](t[27])}return{c(){e=p("tr"),n=p("th"),s=m(A),o=v(),l=p("button"),l.textContent="Descargar",r=v(),c=p("th"),i=m(P),h=v(),$=p("th"),y=p("img"),E=v(),x(l,"class","svelte-1xo9i92"),x(n,"class","svelte-1xo9i92"),x(c,"class","svelte-1xo9i92"),a(y.src,w=t[27].screenshot)||x(y,"src",w),x(y,"alt",_=t[27].name),x(y,"class","svelte-1xo9i92"),x($,"class","svelte-1xo9i92"),x(e,"class","svelte-1xo9i92")},m(t,a){f(t,e,a),u(e,n),u(n,s),u(n,o),u(n,l),u(e,r),u(e,c),u(c,i),u(e,h),u(e,$),u($,y),u(e,E),C||(k=g(l,"click",L),C=!0)},p(e,n){t=e,16&n[0]&&A!==(A=t[27].id+"")&&b(s,A),16&n[0]&&P!==(P=t[27].name+"")&&b(i,P),16&n[0]&&!a(y.src,w=t[27].screenshot)&&x(y,"src",w),16&n[0]&&_!==(_=t[27].name)&&x(y,"alt",_)},d(t){t&&d(e),C=!1,k()}}}function J(e){let n,s,o;return{c(){n=p("button"),n.textContent="Abrir",x(n,"class","svelte-1xo9i92")},m(t,l){f(t,n,l),s||(o=g(n,"click",e[22]),s=!0)},p:t,d(t){t&&d(n),s=!1,o()}}}function R(e){let n,s,o,l,r,c,a,g,$,y,w=e[5],_=[];for(let t=0;t<w.length;t+=1)_[t]=U(G(e,w,t));function E(t,e){return null===t[9]?z:q}let C=E(e),k=C(e),A=""!==e[2]&&J(e);return{c(){n=p("div"),s=p("table"),o=p("tr"),o.innerHTML='<th class="svelte-1xo9i92"><h1 class="svelte-1xo9i92">Entorno</h1></th> \n            <th class="svelte-1xo9i92"><h1 class="svelte-1xo9i92">Miniatura</h1></th>',l=v();for(let t=0;t<_.length;t+=1)_[t].c();r=v(),k.c(),c=v(),a=p("p"),g=m(e[0]),$=v(),A&&A.c(),x(o,"class","table-header svelte-1xo9i92"),x(s,"class","svelte-1xo9i92"),x(n,"class","environment-list svelte-1xo9i92"),x(a,"class",y=i(e[1])+" svelte-1xo9i92")},m(t,e){f(t,n,e),u(n,s),u(s,o),u(s,l);for(let t=0;t<_.length;t+=1)_[t].m(s,null);f(t,r,e),k.m(t,e),f(t,c,e),f(t,a,e),u(a,g),u(a,$),A&&A.m(a,null)},p(t,e){if(65632&e[0]){let n;for(w=t[5],n=0;n<w.length;n+=1){const o=G(t,w,n);_[n]?_[n].p(o,e):(_[n]=U(o),_[n].c(),_[n].m(s,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=w.length}C===(C=E(t))&&k?k.p(t,e):(k.d(1),k=C(t),k&&(k.c(),k.m(c.parentNode,c))),1&e[0]&&b(g,t[0]),""!==t[2]?A?A.p(t,e):(A=J(t),A.c(),A.m(a,null)):A&&(A.d(1),A=null),2&e[0]&&y!==(y=i(t[1])+" svelte-1xo9i92")&&x(a,"class",y)},i:t,o:t,d(t){t&&d(n),h(_,t),t&&d(r),k.d(t),t&&d(c),t&&d(a),A&&A.d()}}}function V(t,e,n){let s,o,l="",r="progress",c="",a="https://demo.sim3d.es",i=[],u=[],f="",d=null,h=null,p=[];const m=async()=>{try{n(0,l="Obteniendo lista de escenas"),n(1,r="progress");const t=await window.fsAPI.getAvailableScenes(a,d);n(4,i=t.scenes),n(0,l=""),n(1,r="success")}catch(t){n(0,l=t.message),n(1,r="fail")}},v=async t=>{try{n(0,l="Descargando escena"),n(1,r="progress");const e=("/"!==a[a.length-1]?a+"/":a)+`api/v1/bg2scene/${t}/scene.vitscnj`,s=`scene-${t}`,o=await window.fsAPI.downloadScene(e,s);n(1,r="success"),n(0,l=`Escena descargada en la ruta ${o}. Abriendo entorno...`),n(2,c=o),await fsAPI.launchEnvironment()}catch(t){n(1,r="fail"),n(0,l="Error descargando la escena. Comprueba la URL del servidor"),console.error(t)}},g=async()=>{await fsAPI.launchEnvironment()},x=async t=>{n(6,f=await window.fsAPI.setCurrentEnvironment(t))};w((async()=>{n(5,u=await window.fsAPI.getEnvironments()),n(6,f=await window.fsAPI.getCurrentEnvironment()),n(9,h=null)}));return[l,r,c,a,i,u,f,s,o,h,p,async t=>{t.stopPropagation(),t.preventDefault();const e=new Headers;e.append("Content-Type","application/json");const c=JSON.stringify({user:s,pass:o}),i=await fetch(`${a}/api/v1/login`,{method:"POST",body:c,headers:e,redirect:"follow"});if(i.ok){const t=await i.json();n(9,h=t.token),await(async()=>{const t=new Headers;t.append("x-access-token",h);const e=await fetch(`${a}/api/v1/clients`,{method:"GET",headers:t});if(e.ok){const t=await e.json();n(10,p=t.data.map((({id:t,name:e})=>({id:t,name:e})))),d=p.length&&p[0].id||null,d&&m()}else n(0,l="Error inesperado al cargar el listado de clientes. Cierre sesión y vuelva a entrar, y si el problema persiste, consulte con Grupo SIM"),n(1,r="fail")})()}else n(0,l="Login error: check your user name and password"),n(1,r="fail")},()=>{n(9,h=null)},async t=>{d=t.target.value,await m()},v,g,x,async t=>await x(t.name),function(){a=this.value,n(3,a)},function(){s=this.value,n(7,s)},function(){o=this.value,n(8,o)},async t=>await v(t.id),()=>g()]}new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),O(this,t,V,R,l,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=renderer.js.map
